---
title: "PROGRAMMING RUST"
date: 2018-02-05 06:29:03
---

機械学習系の小難しい本ばかり読んでると疲れるので、息抜きになんか新しいプログラミング言語の本でも読むか、と買った、rustの本。

<iframe style="width:120px;height:240px;" marginwidth="0" marginheight="0" scrolling="no" frameborder="0" src="https://rcm-fe.amazon-adsystem.com/e/cm?ref=qf_sp_asin_til&t=karino203-22&m=amazon&o=9&p=8&l=as1&IS1=1&detail=1&asins=B077NSY211&bc1=ffffff&lt1=_top&fc1=333333&lc1=0066c0&bg1=ffffff&f=ifr"> </iframe>

別段使う気も無く、単なる教養として読む気です。

### 2章まで

単語が分からない。  
admonish 勧告する

最初の方の例のunwrapというものがなんなのか、説明読んでも良く分からなかった。
とりあえず先に進むと分かるようになるのを期待。

Result型とかを見てると、代数的データ型なのかね。

マンデルブロの例はコード以外の説明が長くてゲンナリする。なんで開幕にこの例を持ってきてしまうのか…

chunks_mutとかは、お、なんか下ではいろいろありそうだな、という気がする。
スレッド同士の協調作業が無い例だといまいち実力の程は分からないが、それは以後に期待か。

### rustってどこに使うのだろう？

使う気は無いとはいえ、そういうモチベーションの所は気になる。

言語的には軽く使える関数型言語っぽいスクリプト、という印象だが、これ、どこに使うのだろうか？

メモリの制約とか気にしてる！とか言っててCとかC++が良く言及されてるので、Cの代わりに使うのか？

Cというとメモリのディスクリプタをセットアップしてない状態でバイナリ操作してPCIeのパラメータを変更したりSPIとかの少し込み入ったプロトコルを持つデバイスを叩くのに使うよな。

そういう用途なのなしら？

とりあえずランタイム無しで動かすとどうなるんだろう？と少しググるとこんなのが。

[zero.rs](https://github.com/pcwalton/zero.rs/blob/master/zero.rs)

ふむ、memcpy, memmove, abortくらいはアセンブリで書いてやるが、mallocとfreeは辛いなぁ。
というかなんでコード領域じゃない文字列要るんだ？

なんかあんまりC言語の代わりに使える感じはしない。
ただmalloc相当の物を用意するくらいは出来る環境もあるだろう。
へんてこなデバイス上のクロス開発、みたいなパターンだと、用意しなきゃいけないランタイムが小さいのは良さそう。

ブラウザ書く為に出来た言語なので、ブラウザ書く、というのはまぁいい。
でもデスクトップアプリなんてイマドキほとんど書かないだろう。

並列性が生きる用途ってなんだろう？
例えばMapReduceとかで使うなら言語が並列で動いてもあんまいい事無い。

webサーバーの中で動くスクリプトもそうだよなぁ。

この手の奴とか、コマンドラインのちょっとしたツールくらいなら、
golangくらいのいい加減で面倒が無い言語の方が良い気はする。

RDBのエンジンとかインデクサとかLightGBMとかそういうの作る時には良いかもなぁ。
その辺作る時にこんな感じに書けると良さそうね。

ただそういうのってちょろっと試す用途には向かないよね。ちょろっとRDBMS書くか！とか無理。

サーバーサイドでしか使わない用途じゃないとKotlinで書き直すハメになって辛そうというのも悩ましいな。

何書く時に使うのかなぁ。

### 三章、基本の型

数値のリテラルにアンダーバーが入れられる、ってこれどっかの言語でも見た記憶があるが、流行ってるのか？使った事無いんだが…

floating pointのあたりで飽きてくる。
開幕これって読む人的には結構辛い。
まぁバンバン飛ばせばいいんだろうけれど。

tuppleのインデクシングは即値じゃないと駄目！まじか！
コンパイル時にオフセット決めるのか。

配列とかvectorくらいまで来るとダルさも減ってくるな。
それにしてもcollectは戻りの変数に型が要るって、return valueでもmethod overload出来るのかな。
collect_vecでは何故駄目なのか…という気もするが。

functional languageの定義には笑ってしまった。

stringで内部のエンコーディングの話とかスタック上のリファレンスの中身とかの話が出てくるのはいいね。
rustなんて言語に興味持つならCやC++は当然分かるでしょ？という事だな。

string literalとStringが違うのはいいんだけど、なんか違う名前つけておいて欲しかったなぁ。lstringとか。

----

3章読み終わり。
intとかfloatはさすがにだるかったが、後半のメモリレイアウトから面白くなってくるね。
referenceが必ず長さも持つ、というのは面白い。
厳密には無駄な場合もあるけど、だいたい長さも持つ方がいいよね、というのは昔ガラケー会社でブラウザ書いてた時にもライブラリで一貫して採用してて、結構メモリ制約がきつい所でも頑張ってたのでまぁまぁ同意する所。

本としては、この構成はどうなのかなぁ。
一番挫折しやすい序盤にこのかったるい章を持ってきてしまうのはどうなのか。  
ま、この位なら頑張って乗り越えるけどね。

あとC++プログラマを前提としている気がする。そこまで最新の機能とかは知らなくてもいいだろうけど、スタック上にどうオブジェクトが置かれるか、くらいは知ってる事が前提に思う。

----
