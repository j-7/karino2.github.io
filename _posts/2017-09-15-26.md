---
title: "ZipSourceCodeReadingのTodo"
date: 2017-09-15 05:44:40
---

最近はインデクスを開いてトリグラムを検索するコードをもらってインテグレートしたりしていた。

あとはインデクサを作って、それを呼んだりするコードを書けばとりあえず完成。
インデクサは作ってくれそうなので、呼ぶ側を書かないとなぁ。

考えてる仕様としては、まずはServiceでえいっと全indexを作る。
本当は途中再開も考えて真面目にやらないとAndroidアプリとしてはまずいのだが、まずは一気にから終わらせる間は殺されない、という前提でくっつける。

zipファイルと同じ名前+idx、みたいな感じのファイルがzipファイルと同じ場所か、またはアプリの作ったディレクトリにあればインデクスとして使われる。そうでなければ無いとする、みたいにするつもり。

インデクサはアプリの作ったディレクトリにまずインデクスを作る。これを移動するのはユーザーがファイラーとかで手動でやる、という事にする。

わざわざアプリの指定したフォルダも見るのは、リムーバブルなSDの書き込み権限回りがかったるいから。

そしてzipと同じ所にあるインデクスもサポートするのは、zipとインデクスを両方合わせてバックアップ取って消した後、後日また読みたくなった時にインデクスとzipファイルを合わせてコピーすれば読む環境が再現出来るように、という事で。

インデクスファイルは普通読む対象の1/3くらいのサイズなので、zipしたファイルよりは大きくなる事もありそう。
そこそこでかいので、バックアップ取ったり消したり、はユーザーにやってもらう必要がある気はしている。

何にせよ、インデクサさえ出来ればとりあえず使える所までは行きそうだ。
コード読みアプリは長らく欲しいと思っていた物なので、ようやく作れてちょっと感慨深い。
